---
title: "Appendix"
output:
  bookdown::word_document2:
    reference_docx: ../documentation/wordtemplate.docx
    toc: true
    toc_depth: 6
  github_document:
      toc: true
      toc_depth: 6
urlcolor: blue
always_allow_html: yes
---

```{r temp-appendix-setup, include = FALSE}
load(file.path(here(), "data-intermediate/documentation/park-appendices.rda"))
```

# Appendix

## Resources

### Our partner organizations
This research was made possible by collaboration with partner organizations and Legacy Amendment funding. 

- [Minnesota Legacy and Trust Funds](https://www.legacy.mn.gov/) were the source of funding for this research.
- [The Parks and Trails Legacy Advisory Committee](https://www.legacy.mn.gov/ptlac) provided guidance for this research project.
- The [Department of Natural Resources]( Department of Natural Resources) manages state parks and trails.
- [Greater Minnesota Regional Parks and Trails Commission](https://www.gmrptcommission.org/) designates regional parks and trails in the 80 counties of Greater Minnesota.
- Metropolitan regional parks and trails are supported by the [Metropolitan Council](https://metrocouncil.org/Handbook/Plan-Elements/Parks.aspx) in partnership with [ten regional implementing agencies](https://metrocouncil.org/Parks/About/Partners.aspx).

### Data sources
Complete methods for this research can be found in the technical documentation. 

- [StreetLight Data, Inc.](https://www.streetlightdata.com/) provided anonymized and aggregated location-based services data.
- The Minnesota Geospatial Data Commons contains geography files for [DNR State parks](https://gisdata.mn.gov/dataset/bdry-dnr-lrs-prk), [DNR State trails](https://gisdata.mn.gov/dataset/trans-state-trails-minnesota), [Metro Regional parks](https://gisdata.mn.gov/dataset/us-mn-state-metc-plan-parks-regional), and [Metro Regional trails](https://gisdata.mn.gov/dataset/us-mn-state-metc-trans-regional-trails-exst-plan). Greater MN Regional park and trail files were accessed via personal communication. 

### More about Minnesota parks and trails

- [Minnesota Great Outdoors](https://mn.gov/greatoutdoors/) is another Legacy-funded collaborative project between DNR, Greater MN Regional Parks and Trails Commission, and the Metropolitan Council to provide web-based information for park and trail users.
 
 
## FAQ

### What is this project? 
This exploratory research project aimed to determine the utility of location-based services (LBS) data for estimating park and trail use in Minnesota. LBS data was obtained from StreetLight Data, Inc. and was used to estimate park and trail use across three park systems: Department of Natural Resources state parks and trails (DNR state), Greater Minnesota regional parks and trails (Greater MN regional), and Twin Cities metropolitan regional parks and trails managed by ten implementing agencies in collaboration with the Metropolitan Council (Metro Regional). The project was funded with Legacy Partnership Research Funds from the State of Minnesota Parks and Trails Legacy Fund in collaboration with the three systems. 

###What is StreetLight Data? 
[StreetLight Data, Inc.](https://www.streetlightdata.com/) is the provider of LBS data for this project. StreetLight purchases anonymized LBS data from third-party vendors, such as [Cuebiq](https://www.cuebiq.com/) . StreetLight then processes the data, completing quality assurance and statistical tests. The project team received aggregated and anonymized travel patterns which were used for analysis. The data vendor implements data privacy methods, and it is not possible to identify individuals or individual trips through this data source or these methods. 

Broadly, LBS data is generated by GPS-enabled devices (i.e., smartphones) where users have “opted-in” to using location services. Common examples of third-party applications where users can opt in to using location services are weather, fitness, and mapping applications. Cell phone service (i.e., LTE, 3G, 4G) is not necessary for GPS functionality. StreetLight Data, Inc. uses “penetration rates” to account for incomplete adoption of GPS-enabled devices (i.e., smartphones) and users who have not opted-in to location services. StreetLight Data, Inc.’s algorithms clean the data and convert device count (i.e., sample size) into estimates of vehicles, pedestrians, and bikes which are used in this research. The LBS data provider does not explicitly measure visitors arriving by other transportation modes, but other modes (i.e., snowmobiles, boaters) may be captured and classified as either vehicle, bike, or foot visitors by the LBS data provider using their probabilistic models. 

More information about StreetLight Data, Inc.’s process can be found [on their website](https://www.streetlightdata.com/). 

### What are the benefits of using LBS/StreetLight? 
LBS data meaningfully complement existing park and trail use estimates (i.e., intercept surveys, manual counts, or physical trail counters). LBS data is available for parks and trails even when surveys or manual counts have not been performed. This research project processed data for all parks and trails eligible to receive Legacy funding, regardless of existing capacity for research or data collection. 

Additionally, LBS data has unique strengths in providing detailed spatial and temporal information. This project produced estimates for individual parks at weekly time intervals and individual trails at monthly time intervals. Data is available for January 2019 - April 2022. 

Please note that there are many park and trail research methods. Each has benefits and drawbacks; LBS data is not the appropriate tool for all research questions. 

### What can we measure? 
The LBS data used in this project includes estimated counts of vehicles, bicyclists, and pedestrians. We must apply a vehicle multiplier (average number of persons per vehicle) to convert vehicle counts to visitor counts. These counts are combined to estimate of total use at each park and trail. 

This data is available in monthly time intervals for trails and weekly time intervals for parks, allowing for detailed time series trend analyses. 

Visitor demographics are inferred based on census data. While inferred demographics are informative, they are different than intercept surveyed responses and cannot capture visitors’ lived experiences. 

The LBS data provider does not explicitly measure visitors arriving by other transportation modes, but other modes (i.e., snowmobiles, boats, equestrians, skiers) may be captured and classified as either vehicles, bikers or walkers by the LBS data provider using their probabilistic models. It cannot identify unique versus repeat visitors, nor can it measure how long visitors spend at a park or trail. Devices registered to minors (under age 18) are not included in the LBS data source. 

### How were vehicle multipliers determined? 
For Metro Regional parks, agency-level vehicle multipliers ranging between 1.71 and 2.72 were applied. State parks use a vehicle multiplier of 3.2 based on current DNR practices. We recommend 2.46 as a baseline vehicle multiplier for Greater Minnesota Regional parks. This is the average of the suburban Metro Regional agency multipliers and the DNR State park multiplier. 

### Why don’t park boundaries match official park boundaries? 
Park boundaries were edited to remove unrelated roads in order to isolate park visitors. In some cases, boundaries were expanded to include lake or river shores or amenities, such as trailheads and parking lots, that fell outside of original park boundaries. In many cases, boundaries were edited based on feedback requested throughout the project. Park and trail boundaries, in addition the number of parks and trails, remained constant over the course of this study (January 2019 – April 2022). 

### Why don't trail segments match official trail alignments?
This can happen for several reasons. Very short segments, or segments which are primarily highways, may be excluded on purpose. Otherwise, differences between trail alignments and segments are explained by OpenStreetMap data availability. In some cases, when trails run alongside roads, the best OSM match will include a longer section of road than appropriate. In other cases, the trail simply isn’t represented in OSM data. This is most common for trails still under development or for short sections or spurs. 

Trail geographies were edited based on provided shapefiles and maps available via respective agency websites, OpenStreetMap, and sources such as Minnesota Great Outdoors, AllTrails, etc. Revisions to OpenStreetMap data are beyond the scope of this project. 

### How does this project affect my park/trail? 
Data from this project is intended to supplement existing data. All partners have assisted in funding this research project, but the data from this project is not linked to funding allocation. 

### What’s next with StreetLight? 
Recent industry-wide changes to the availability of location-based services (LBS) data have forced StreetLight, and other data providers, to adopt new data sources and strategies. As of May 2022, LBS data is no longer available. Other data sources that StreetLight and other providers are migrating to are not suitable for park and trail research at this time. 

### What’s next for this project? 
We recommend using the findings from this work to guide other research until the future of LBS data is more clear. For example, these results may be used to refine existing research questions. Please view the “Recommendations and Future Work” and “Use Case” sections for more detail. At this time, the results from this project using LBS data should be viewed as a discrete research project which estimated visitation from January 2019 – April 2022 rather than part of a continuous (ongoing) research project. 




## Park units excluded from analysis

Parks were excluded from the analysis for several reasons. Some parks were excluded from the project sample entirely, others were excluded from portions of the analysis but remained in the project sample. This appendix documents the basis for these exclusions. 

### Geography-based exclusions

Several units were dropped before any LBS analyses were run due to geography issues (Table \@ref(tab:parks-dropped-pre-LBS)). Islands were removed, as were parks less than 10,000m$^2$ in area. Islands were excluded because the LBS provider does not explicitly measure boat activity. Units under 10,000m$^2$ were excluded due to data coverage concerns (the LBS provider flags any areas under this threshold). 

```{r parks-dropped-pre-LBS}
dropped_pre_LBS %>%
  arrange(system, unit_name) %>%
  mutate(reason = str_remove_all(reason, "\\.")) %>%
  transmute(System = system, Unit = unit_name, Cause = reason) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Park units excluded from all analyses due to their geography.") %>%
  theme_zebra()
```

### Coverage-based exclusions

Several units were excluded from the project sample after LBS analyses were run. Units which were missing vehicle data for >50% of the weeks in the analysis period were excluded (Table \@ref(tab:parks-excluded-entirely)). Several units returned vehicle and pedestrian, but no bicycle data (Table \@ref(tab:parks-excluded-bike)). These parks remained in the project sample and bike activity was assumed to be 0. Finally, a number of parks returned bike data for <50% of months in the analysis period (Table \@ref(tab:parks-no-bike-imputation)). These parks remained in the project sample, but no imputation was performed to fill missing bike estimates due to insufficient data. Bike use was assumed to be 0 for missing months at these units. 

```{r parks-excluded-entirely}
dropped_entirely %>%
  arrange(system, unit_name) %>%
  transmute(System = system, Unit = unit_name) %>%
  flextable() %>%
  autofit() %>%
  set_caption("Park units excluded after running LBS analyses due to low coverage (missing >50% of weekly records).") %>%
  theme_zebra()
```

```{r parks-excluded-bike}
dropped_bike_only %>%
  arrange(system, unit_name) %>%
  transmute(System = system, Unit = unit_name) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Park units for which no bike data was returned") %>%
  theme_zebra()
```

```{r parks-no-bike-imputation}
no_bike_imputation %>%
  arrange(system, unit_name) %>%
  transmute(System = system, Unit = unit_name) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Parks for which no bike imputation was performed due to low coverage (missing >50% of monthly bike records).") %>%
  theme_zebra()
```


## Park geography exceptions

All park geography was edited using the procedure described in the parks methodology section of this report. In a number of cases, however, we deviated from the procedure to improve LBS performance at a given park. Table \@ref(tab:park-geography-exceptions) documents these changes and a brief explanation of our rationale. The most common change was to reduce the size of the buffer used to remove unrelated roads from park boundaries. This was in order to avoid removing parking lots or other amenities close to the road. 

```{r park-geography-exceptions}
geography_exceptions %>%
  arrange(system_label, unit_label) %>%
  transmute(System = system_label, Unit = unit_label, Exception = exception) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Parks for which additional geographic edits were conducted.") %>%
  theme_zebra()
```


## Unresolved park geography concerns

The project team was not able to resolve every concern regarding park geography. Table \@ref(tab:park-unresolved-geography) documents parks for which additional geography edits may be appropriate. There are a few key concerns remaining. Some park shapefiles may not include all relevant parking; others were misaligned and manually edited. Narrow parks or parks with complex geographies are challenging to isolate and may be better-refined by staff more familiar with the park. 

```{r park-unresolved-geography}
unresolved_geography %>%
  arrange(system_label, unit_label) %>%
  mutate(concern = case_when(
    concern %in% c("Narrow", "Complicated geography") ~ "Complex or narrow geography, difficult to isolate",
    concern == "Parking" ~ "Parking may lie outside of boundary",
    concern == "Misaligned shapefile" ~ "Original shapefile misaligned",
    concern == "North Shore" ~ "Difficult to isolate from Hwy 61 and/or Gitchi Gami State Trail",
    TRUE ~ concern
  )) %>%
  transmute(System = system_label, Unit = unit_label, Concern = concern) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Parks with unresolved geography concerns.") %>%
  theme_zebra()
```

## Trail units/segments excluded from analysis

### Geography-based exclusions

Trails were excluded from the analysis for several reasons. Some trails were removed before LBS analyses were run due to limited OSM data (Table \@ref(tab:trails-dropped-pre-LBS). In these cases, some OSM segments may have been identified, but coverage was insufficient for reasonable analysis. Additionally, any identified OSM segments less than 50ft in length were excluded (Table \@ref(tab:segments-dropped-length). In these cases, trails remained in the analysis. 

```{r trails-dropped-pre-LBS}
load(file.path(here(), "data-intermediate/documentation/trail-appendices.rda"))

dropped_pre_LBS %>%
  transmute(System = system, Unit = unit_name) %>%
  arrange(System, Unit) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Trails excluded from all analyses due to insufficient OSM coverage") %>%
  theme_zebra()
```


```{r segments-dropped-length}
dropped_for_length %>%
  ungroup() %>%
  transmute(System = system, Unit = unit_label, `Dropped segments` = dropped_segments) %>%
  arrange(System, Unit) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Summary of OSM segments dropped from analysis due to length (<50ft)") %>%
  theme_zebra()
```

### Coverage-based exclusions

Several trail units/segments were excluded from the project sample after LBS analyses were run. Two units returned no LBS data for any segments (Table \@ref(tab:trails-dropped-entirely)). When individual trail segments did not return LBS data, the associated trail remained in the project sample and use was assumed to be zero on missing segments. In total, 200 identified OSM segments returned no LBS data (Table \@ref(tab:dropped-segments)). 

```{r trails-dropped-entirely}
dropped_entirely %>%
  transmute(System = system, Unit = unit_name) %>%
  arrange(System, Unit) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Trails for which no LBS data was available") %>%
  theme_zebra()
```

```{r dropped-segments}
dropped_segments %>%
  ungroup() %>%
  transmute(System = system, Unit = unit_label, `Dropped segments` = dropped_segments) %>%
  arrange(System, Unit) %>%
  flextable() %>%
  autofit(add_w = 0, add_h = 0) %>%
  set_table_properties(layout = "autofit") %>%
  set_caption("Summary of OSM for which no LBS data was available. Use was assumed to be zero on these segments.") %>%
  theme_zebra()
```

